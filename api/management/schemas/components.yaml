components:
  schemas:
    Policy:
      required:
        - type
        - name
        - uuid
        - active
        - ctime
        - rules
      properties:
        type:
          type: string
          description: >
            This corresponds to the name of the policy agent backend, and
            defines the syntax/structure of the policy. E.g. policies of "opa"
            type are expected to written in Rego language.
          example: opa
        name:
          type: string
          description: >
            The name given to the policy when it is added. This also attaching
            a label to the policy that is meaningful to the uploader, and to
            distinguish between different policies for the same scheme.
          example: default
        uuid:
          type: string
          description: >
            A unique identifier for this specific policy in the standard
            8-4-4-4-12 form.
          example: 340d22f7-9eda-499f-9aa2-5af295d6d812
        active:
          type: boolean
          description: >
            Indicates whether this policy is active. The active policy is the
            one that is used when creating an attestation result for the
            corresponding scheme. Currently, only one policy for a scheme can
            be active at  a time.
        ctime:
          type: string
          format: date-time
          description: >
            Create time of the policy.
          example: 2023-07-06T00:00:00Z
        rules:
          type: string
          description: >
            The rules comprising the policy. The exact format of these is
            determined by the type.
    Problem:
      required:
        - title
      properties:
        type:
          type: string
          description: >
            A URI reference [RFC3986] that identifies the problem type.  This
            specification encourages that, when dereferenced, it provide
            human-readable documentation for the problem type (e.g., using HTML
            [W3C.REC-html5-20141028]).  When this member is not present, its
            value is assumed to be "about:blank".
          example: about:blank
        title:
          type: string
          description: >
            A short, human-readable summary of the problem type.  It SHOULD NOT
            change from occurrence to occurrence of the problem, except for
            purposes of localization (e.g., using proactive content
            negotiation; see [RFC7231], Section 3.4).
          example: Not Found
        status:
          type: integer
          description: >
            The HTTP status code ([RFC7231], Section 6) generated by the
            origin server for this occurrence of the problem.
          example: 404
        detail:
          type: string
          description: >
            A human-readable explanation specific to this occurrence
            of the problem.
          example: no active session could be located at the requested URL
        instance:
          type: string
          format: uri
          description: >
            A URI reference that identifies the specific occurrence of
            the problem.  It may or may not yield further information if
            dereferenced.
          example: https://veraison.example/v1/problems/404
  responses:
    Error:
      description: >
        Unexpected error
      content:
        application/problem+json:
          schema:
            $ref: '#/components/schemas/Problem'



